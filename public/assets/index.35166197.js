import{r as b,o as u,c,a as o,b as m,w as v,d as k,F as f,e as T,l as D,t as y,f as B,g as $,E as H,h as P,i as M,j as S,k as g,v as w,m as V,n as F,p as J,q as G,s as j,u as q,x as W,y as X}from"./vendor.43cd9eef.js";const z=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerpolicy&&(r.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?r.credentials="include":s.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function l(s){if(s.ep)return;s.ep=!0;const r=n(s);fetch(s.href,r)}};z();var Q="/assets/02_rubber_duck.f77ab927.png",p=(t,e)=>{const n=t.__vccOpts||t;for(const[l,s]of e)n[l]=s;return n};const K={name:"app-header",methods:{goHome(){this.$router.push("/")},logout(){this.$store.dispatch("logout")}},computed:{user(){return this.$store.getters.getUser}}},Y={class:"header-container"},Z={class:"main-app-header flex space-between align-center container"},ee=o("div",{class:"logo-img"},[o("img",{src:Q,alt:"Rubber Duck"})],-1),te=o("h1",null,"Toys",-1),se=[ee,te],oe={class:"nav-bar-container"},ne=T("Home"),re=T("Reviews"),ie=T("Login"),le=T("User");function ae(t,e,n,l,s,r){const i=b("router-link");return u(),c("header",Y,[o("section",Z,[o("div",{onClick:e[0]||(e[0]=(...a)=>r.goHome&&r.goHome(...a)),class:"logo flex align-end"},se),o("div",oe,[m(i,{to:"/",class:"nav-bar-link"},{default:v(()=>[ne]),_:1}),m(i,{to:"/review",class:"nav-bar-link"},{default:v(()=>[re]),_:1}),r.user?(u(),c(f,{key:1},[m(i,{to:"/User",class:"nav-bar-link"},{default:v(()=>[le]),_:1}),o("button",{onClick:e[1]||(e[1]=(...a)=>r.logout&&r.logout(...a)),class:"nav-bar-link"},"Logout")],64)):(u(),k(i,{key:0,to:"/login",class:"nav-bar-link"},{default:v(()=>[ie]),_:1}))])])])}var ue=p(K,[["render",ae]]);const ce="",h=de();window.socketService=h;h.setup();function de(){var t=null;const e={setup(){t=D(ce)},on(n,l){t||e.setup(),t.on(n,l)},off(n,l){t||e.setup(),l?t.off(n,l):t.removeAllListeners(n)},emit(n,l){t==null||t.emit(n,l)},terminate(){t=null}};return e}const ye={created(){this.$store.dispatch("loadToys"),h.on("something-changed",this.alertSomethingChanged)},methods:{alertSomethingChanged(){alert("Admin has updated the store...")}},components:{appHeader:ue}},pe={id:"app",class:"main-layout flex column"},me=o("footer",{class:"main-app-footer flex center-center"},[o("h5",null,"copyright")],-1);function he(t,e,n,l,s,r){const i=b("app-header"),a=b("router-view");return u(),c("div",pe,[m(i),m(a,{class:"flex column grow-1"}),me])}var ge=p(ye,[["render",he]]);const _e={props:{toy:Object},methods:{showToyDetails(){this.$router.push("/toy/"+this.toy._id)},toEdit(t){this.$router.push(`/toy/edit/${t}`)},removeToy(){this.$store.dispatch({type:"removeToy",toyId:this.toy._id})}}},ve={class:"toy-preview-info flex column space-between"},fe={class:"toy-preview-btns flex column space-between"};function we(t,e,n,l,s,r){return u(),c("li",{class:"toy-preview-container flex space-between",onClick:e[2]||(e[2]=(...i)=>r.showToyDetails&&r.showToyDetails(...i))},[o("div",ve,[o("div",null,[o("h3",null,y(n.toy.name),1)]),o("h4",null,y(n.toy.price),1)]),o("div",fe,[o("button",{onClick:e[0]||(e[0]=i=>r.toEdit(n.toy._id))},"Edit"),o("button",{class:"btn",onClick:e[1]||(e[1]=B((...i)=>r.removeToy&&r.removeToy(...i),["stop"]))},"X")])])}var be=p(_e,[["render",we]]);const $e={props:{toys:Array},components:{toyPreview:be},methods:{toAddToy(){this.$router.push("/toy/edit")}}},ke={class:"toy-list-container"},Te={class:"toy-list clean-list toy-list-layout"};function xe(t,e,n,l,s,r){const i=b("toy-preview");return u(),c("section",ke,[o("button",{onClick:e[0]||(e[0]=a=>r.toAddToy())},"Add Toy"),o("ul",Te,[(u(!0),c(f,null,$(n.toys,a=>(u(),k(i,{key:a._id,toy:a},null,8,["toy"]))),128))])])}var Se=p($e,[["render",xe],["__scopeId","data-v-52d6bed8"]]);const Ue={data(){return{filter:{name:"",inStock:"All",type:"All",test:[]},labels:["On wheels","Box game","Art","Baby","Doll","Puzzle","Outdoor"],sortBy:"",typeOptions:[{value:"All",label:"all"},{value:"Educational",label:"edu"},{value:"Funny",label:"funny"},{value:"Adult",label:"adult"}],sortOptions:[{value:"name",label:"name"},{value:"price",label:"price"}],stockOptions:[{value:"All",label:"all"},{value:!0,label:"inStock"},{value:!1,label:"outStock"}]}},methods:{setFilterBy(){var t=this.filter;console.log(t),this.$store.commit({type:"setFilterBy",filterBy:JSON.parse(JSON.stringify(t))}),this.$store.dispatch("loadToys")},setSortBy(){this.$store.commit({type:"sortBy",sortBy:JSON.parse(JSON.stringify(this.sortBy))})}}},Ce={class:"main-filter-container flex space-between"},Be={class:"filter-container flex align-end"},Ie=o("h4",null,"name",-1),Re=o("h4",null,"type",-1),Oe=o("h4",null,"stock",-1),Ae={class:"sort-container flex align-end"},Ee=o("h4",null,"sort",-1);function Ve(t,e,n,l,s,r){const i=H,a=P,R=M;return u(),c("div",Ce,[o("div",Be,[o("label",null,[Ie,m(i,{type:"text",placeholder:"search",modelValue:s.filter.name,"onUpdate:modelValue":e[0]||(e[0]=d=>s.filter.name=d),onInput:r.setFilterBy},null,8,["modelValue","onInput"])]),o("label",null,[Re,m(R,{onChange:r.setFilterBy,modelValue:s.filter.type,"onUpdate:modelValue":e[1]||(e[1]=d=>s.filter.type=d)},{default:v(()=>[(u(!0),c(f,null,$(s.typeOptions,d=>(u(),k(a,{key:d.value,label:d.label,value:d.value},null,8,["label","value"]))),128))]),_:1},8,["onChange","modelValue"])]),o("label",null,[Oe,m(R,{onChange:r.setFilterBy,modelValue:s.filter.inStock,"onUpdate:modelValue":e[2]||(e[2]=d=>s.filter.inStock=d)},{default:v(()=>[(u(!0),c(f,null,$(s.stockOptions,d=>(u(),k(a,{key:d.value,label:d.label,value:d.value},null,8,["label","value"]))),128))]),_:1},8,["onChange","modelValue"])])]),o("div",Ae,[o("label",null,[Ee,m(R,{modelValue:s.sortBy,"onUpdate:modelValue":e[3]||(e[3]=d=>s.sortBy=d),onChange:r.setSortBy,placeholder:""},{default:v(()=>[(u(!0),c(f,null,$(s.sortOptions,d=>(u(),k(a,{key:d.value,label:d.label,value:d.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])])])])}var Ne=p(Ue,[["render",Ve]]);const Le={computed:{toys(){return this.$store.getters.getToys}},components:{toyList:Se,toyFilter:Ne}},De={class:"toy-app-container container"};function He(t,e,n,l,s,r){const i=b("toy-filter"),a=b("toy-list");return u(),c("section",De,[m(i),r.toys?(u(),k(a,{key:0,toys:r.toys},null,8,["toys"])):S("",!0)])}var Pe=p(Le,[["render",He]]);function Me(t,e=700){let n;return function(...l){const s=()=>{clearTimeout(n),t(...l)};clearTimeout(n),n=setTimeout(s,e)}}const Fe={name:"chat-room",props:{toyId:String,msgHistory:Array},data(){return{msg:"",msgs:[],typingUser:null}},computed:{user(){return this.$store.getters.getUser}},methods:{addMsg(t){this.msgs.push(t)},sendMsg(){var e;const t={txt:this.msg,username:((e=this.user)==null?void 0:e.username)||"Guest"};h.emit("chat newMsg",t),this.msg=""},typing(){this.setTyping(),this.bounce()},setTyping(){var t;h.emit("user-typing",((t=this.user)==null?void 0:t.username)||"Guest")},clearTyping(){h.emit("user-typing",null)},saveChatHistory(){this.$emit("saveChatHistory",this.msgs)}},created(){h.emit("chat topic",this.toyId),h.on("chat addMsg",this.addMsg),h.on("user-typing",t=>{this.typingUser=t}),this.bounce=Me(this.clearTyping)},unmounted(){h.off("chat addMsg",this.addMsg),h.off("user-typing"),this.saveChatHistory()}},Je={class:"chat-room-container"},Ge=o("h2",null,"Chat",-1),je={key:0},qe={class:"chat-list"},We={class:"send-box flex"};function Xe(t,e,n,l,s,r){return u(),c("div",Je,[Ge,o("div",{onClick:e[0]||(e[0]=i=>t.$emit("close")),class:"close-btn"},"X"),s.typingUser?(u(),c("h3",je,y(s.typingUser)+" is typing...",1)):S("",!0),o("div",qe,[(u(!0),c(f,null,$([...n.msgHistory,...s.msgs],(i,a)=>(u(),c("p",{key:a,class:"chat-msg"},y(i.username)+": "+y(i.txt),1))),128))]),o("div",We,[g(o("input",{class:"grow-1",type:"text","onUpdate:modelValue":e[1]||(e[1]=i=>s.msg=i),onInput:e[2]||(e[2]=(...i)=>r.typing&&r.typing(...i)),placeholder:"Write your message"},null,544),[[w,s.msg]]),o("button",{onClick:e[3]||(e[3]=(...i)=>r.sendMsg&&r.sendMsg(...i)),class:"btn"},"Send")])])}var ze=p(Fe,[["render",Xe]]);const Qe={data(){return{toy:null,review:"",isChat:!1}},components:{chatRoom:ze},computed:{toyInStock(){return this.toy.inStock?"Toy is in stock":"Toy is not available in stock"},date(){return new Date(this.toy.createdAt).toLocaleDateString()},reviews(){return this.$store.getters.getReviews}},created(){var t=this.$route.params.id;this.getToyById(t),this.getReviews(t)},methods:{async getToyById(t){this.toy=await this.$store.dispatch({type:"getToyById",toyId:t})},async getReviews(t){await this.$store.dispatch({type:"getReviews",filterBy:{toyId:t}})},async addReview(){await this.$store.dispatch({type:"addReview",toyId:this.toy._id,content:this.review}),this.review="",this.getReviews(this.toy._id)},saveChatHistory(t){this.toy.msgs||(this.toy.msgs=[]),this.toy.msgs.push(...t),this.$store.dispatch({type:"saveToy",toy:this.toy})},toggleChat(){this.isChat=!this.isChat}}},Ke={key:0,class:"toy-detailes-container container"},Ye={class:"toy-details flex align-center"},Ze={class:"toy-info"},et={class:"img-container"},tt=["src"],st={key:1,src:"https://www.pulsecarshalton.co.uk/wp-content/uploads/2016/08/jk-placeholder-image.jpg",alt:"image placeholder"},ot={class:"review-container"},nt={class:"review-add flex"},rt={key:0,class:"review-list"},it=o("summary",null,"Reviews",-1);function lt(t,e,n,l,s,r){const i=b("chat-room");return s.toy?(u(),c("div",Ke,[o("div",Ye,[o("div",Ze,[o("h2",null,y(s.toy.name),1),o("h3",null,"Price: $"+y(s.toy.price),1),o("h3",null,"Type: "+y(s.toy.type),1),o("h3",null,y(r.toyInStock),1),o("h4",null,"The toy was created at: "+y(r.date),1)]),o("div",et,[s.toy.imgUrl?(u(),c("img",{key:0,src:s.toy.imgUrl,alt:"toy-img"},null,8,tt)):(u(),c("img",st))])]),o("div",ot,[o("div",nt,[g(o("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>s.review=a),placeholder:"Write your review"},null,512),[[w,s.review]]),o("button",{onClick:e[1]||(e[1]=(...a)=>r.addReview&&r.addReview(...a)),class:"btn"},"Save")]),r.reviews?(u(),c("details",rt,[it,(u(!0),c(f,null,$(r.reviews,a=>(u(),c("div",{key:a._id,class:"review-preview"},[o("h4",null,"By "+y(a.user.username),1),o("p",null,y(a.content),1)]))),128))])):S("",!0)]),s.isChat?(u(),k(i,{key:0,onClose:r.toggleChat,onSaveChatHistory:r.saveChatHistory,msgHistory:s.toy.msgs||[],toyId:s.toy._id},null,8,["onClose","onSaveChatHistory","msgHistory","toyId"])):(u(),c("img",{key:1,onClick:e[2]||(e[2]=(...a)=>r.toggleChat&&r.toggleChat(...a)),class:"chat-icon",src:"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTJxJOgpS0rGQ1jVDxik31OfgfHsX15C_sivQ&usqp=CAU",alt:"chat icon"}))])):S("",!0)}var at=p(Qe,[["render",lt]]);const ut="/api/";var ct=V.create({withCredentials:!0});const _={get(t,e){return C(t,"GET",e)},post(t,e){return C(t,"POST",e)},put(t,e){return C(t,"PUT",e)},delete(t,e){return C(t,"DELETE",e)}};async function C(t,e="GET",n=null){try{return(await ct({url:`${ut}${t}`,method:e,data:n,params:e==="GET"?n:null})).data}catch(l){throw console.log(`Had Issues ${e}ing to the backend, endpoint: ${t}, with data: ${n}`),console.dir(l),l.response&&l.response.status===401&&window.location.assign("/login"),l}}const U="toy";async function dt(t){return await _.get(U,t)}async function yt(t){return await _.get(`${U}/${t}`)}async function pt(t){return await _.delete(`${U}/${t}`)}async function mt(e){var e=JSON.parse(JSON.stringify(e));return e._id?await _.put(`${U}/${e._id}`,e):(e.name||(e.name="Unknown"),await _.post(U,e))}function ht(){var t={name:"",price:0,type:null,inStock:!0,reviews:[]};return t}const x={getToys:dt,getToyById:yt,getEmptyToy:ht,removeToy:pt,saveToy:mt},gt=async t=>{const e="my-test",l="https://api.cloudinary.com/v1_1/rotemc/image/upload",s=new FormData;s.append("file",t),s.append("upload_preset",e);try{return(await V.post(l,s)).data}catch(r){console.error("ERROR!",r)}},_t={name:"toy-edit",data(){return{toy:null,isLoading:!1}},created(){var t=this.$route.params.id;t?this.getToyById(t):this.toy=x.getEmptyToy()},methods:{async getToyById(t){this.toy=await this.$store.dispatch({type:"getToyById",toyId:t})},async saveToy(){await this.$store.dispatch({type:"saveToy",toy:this.toy}),this.$router.push("/")},async uploadImg(t){this.isLoading=!0;const e=t.target.files[0],n=await gt(e);this.toy.imgUrl=n.url,this.isLoading=!1}},components:{}},vt=o("option",{value:"Educational"},"edu",-1),ft=o("option",{value:"Funny"},"funny",-1),wt=o("option",{value:"Adult"},"adult",-1),bt=[vt,ft,wt],$t={class:"in-stock flex space-between align-center"},kt=T("inStock "),Tt=["disabled"];function xt(t,e,n,l,s,r){return s.toy?(u(),c("form",{key:0,onSubmit:e[5]||(e[5]=B((...i)=>r.saveToy&&r.saveToy(...i),["prevent"])),class:"toy-edit-container container flex column"},[g(o("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=i=>s.toy.name=i)},null,512),[[w,s.toy.name]]),g(o("input",{type:"number","onUpdate:modelValue":e[1]||(e[1]=i=>s.toy.price=i)},null,512),[[w,s.toy.price,void 0,{number:!0}]]),g(o("select",{"onUpdate:modelValue":e[2]||(e[2]=i=>s.toy.type=i)},bt,512),[[F,s.toy.type]]),o("label",$t,[kt,g(o("input",{type:"checkbox",class:"custom-checkbox","onUpdate:modelValue":e[3]||(e[3]=i=>s.toy.inStock=i)},null,512),[[J,s.toy.inStock]])]),o("button",{disabled:t.invalid||s.isLoading,class:"btn"},"save",8,Tt),o("input",{type:"file",onChange:e[4]||(e[4]=(...i)=>r.uploadImg&&r.uploadImg(...i))},null,32)],32)):S("",!0)}var St=p(_t,[["render",xt]]);const Ut={name:"login-page",data(){return{cred:{username:"",password:""}}},methods:{async login(){await this.$store.dispatch({type:"login",cred:this.cred}),socketService.emit("set-user-socket",this.$store.getters.getUser._id),this.$router.push("/")}},mounted(){this.$refs.username.focus()}},Ct={class:"login-card flex column space-between"},Bt={class:"login-fields flex column space-between grow-1"},It=o("h3",null,"login",-1),Rt=o("label",null," Username ",-1),Ot=o("label",null," Password ",-1),At=o("button",{class:"login-btn"},"login",-1),Et=T("Don't have an account yet?");function Vt(t,e,n,l,s,r){const i=b("router-link");return u(),c("form",{onSubmit:e[2]||(e[2]=B((...a)=>r.login&&r.login(...a),["prevent"])),class:"login-container form-page"},[o("div",Ct,[o("div",Bt,[It,Rt,g(o("input",{ref:"username","onUpdate:modelValue":e[0]||(e[0]=a=>s.cred.username=a),type:"text"},null,512),[[w,s.cred.username]]),Ot,g(o("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>s.cred.password=a),type:"password"},null,512),[[w,s.cred.password]])]),At]),m(i,{to:"/signup",class:"sec-btn"},{default:v(()=>[Et]),_:1})],32)}var Nt=p(Ut,[["render",Vt]]);const Lt={name:"signup-page",data(){return{cred:{fullname:"",username:"",password:""}}},methods:{async signup(){await this.$store.dispatch({type:"signup",cred:this.cred}),this.$router.push("/")}},mounted(){this.$refs.fullname.focus()}},Dt={class:"signup-card flex column space-between"},Ht={class:"signup-fields flex column space-between grow-1"},Pt=o("h3",null,"Signup",-1),Mt=o("label",null," Full Name ",-1),Ft=o("label",null," Username ",-1),Jt=o("label",null," Password ",-1),Gt=o("button",{class:"signup-btn"},"signup",-1),jt=T("Already signed up?");function qt(t,e,n,l,s,r){const i=b("router-link");return u(),c("form",{onSubmit:e[3]||(e[3]=B((...a)=>r.signup&&r.signup(...a),["prevent"])),class:"signup-container form-page"},[o("div",Dt,[o("div",Ht,[Pt,Mt,g(o("input",{ref:"fullname","onUpdate:modelValue":e[0]||(e[0]=a=>s.cred.fullname=a),type:"text"},null,512),[[w,s.cred.fullname]]),Ft,g(o("input",{"onUpdate:modelValue":e[1]||(e[1]=a=>s.cred.username=a),type:"text"},null,512),[[w,s.cred.username]]),Jt,g(o("input",{"onUpdate:modelValue":e[2]||(e[2]=a=>s.cred.password=a),type:"password"},null,512),[[w,s.cred.password]])]),Gt]),m(i,{to:"/login",class:"sec-btn"},{default:v(()=>[jt]),_:1})],32)}var Wt=p(Lt,[["render",qt]]);const Xt={name:"user-details",computed:{user(){return this.$store.getters.getUser},reviews(){return this.$store.getters.getReviews}},created(){this.$store.dispatch({type:"getReviews",filterBy:{userId:this.user._id}})}},zt={key:0,class:"user-details container"},Qt={key:0,class:"review-list"},Kt=o("summary",null,"Your Reviews",-1),Yt={key:1};function Zt(t,e,n,l,s,r){return r.user?(u(),c("div",zt,[o("h3",null,"Hello "+y(r.user.fullname),1),o("h3",null,"Username: "+y(r.user.username),1),r.reviews?(u(),c("details",Qt,[Kt,(u(!0),c(f,null,$(r.reviews,i=>(u(),c("div",{key:i._id,class:"review-preview"},[o("h4",null,"About: "+y(i.toy.name),1),o("p",null,"Review: "+y(i.content),1)]))),128))])):S("",!0)])):(u(),c("h3",Yt,"No logged In user"))}var es=p(Xt,[["render",Zt]]);const ts={name:"review-page",computed:{reviews(){return this.$store.getters.getReviews}},created(){this.$store.dispatch({type:"getReviews"})}},ss={class:"review-page-container"},os=o("h1",null,"Reviews",-1);function ns(t,e,n,l,s,r){return u(),c("div",ss,[os,(u(!0),c(f,null,$(r.reviews,i=>(u(),c("div",{key:i._id,class:"review-preview flex column align-center"},[o("h4",null,"About: "+y(i.toy.name),1),o("h4",null,"By: "+y(i.user.username),1),o("p",null,"Review: "+y(i.content),1)]))),128))])}var rs=p(ts,[["render",ns]]);const N=G({history:j("/"),routes:[{path:"/",name:"toy-app",component:Pe},{path:"/toy/edit/:id?",name:"toy-edit",component:St},{path:"/toy/:id",name:"toy-details",component:at},{path:"/login",name:"login-page",component:Nt},{path:"/signup",name:"signup-page",component:Wt},{path:"/user",name:"user-details",component:es},{path:"/review",name:"review-page",component:rs}]});var is={state:{toys:null,filterBy:null},getters:{getToys(t){return t.toys}},mutations:{setToys(t,{toys:e}){t.toys=e},setFilterBy(t,{filterBy:e}){t.filterBy=e},sortBy(t,{sortBy:e}){var n=JSON.parse(JSON.stringify(t.toys));e?t.toys=n.sort((l,s)=>{let r=l[e],i=s[e];return e==="name"&&(r=r.toLowerCase(),i=i.toLowerCase()),r>i?1:-1}):t.toys=n},removeToy(t,{toyId:e}){var n=JSON.parse(JSON.stringify(t.toys)),l=n.findIndex(s=>s._id===e);n.splice(l,1),t.toys=n},addToy(t,{toy:e}){t.toys.push(e)},updateToy(t,{toy:e}){const n=t.toys.findIndex(l=>l._id===e._id);t.toys.splice(n,1,e)}},actions:{async loadToys(t){try{var e=t.state.filterBy?t.state.filterBy:"";const n=await x.getToys(e);return t.commit({type:"setToys",toys:n}),n}catch(n){console.log(n)}},async getToyById(t,{toyId:e}){try{return await x.getToyById(e)}catch(n){console.log(n)}},getEmptyToy(){return x.getEmptyToy()},async removeToy(t,{toyId:e}){try{await x.removeToy(e),t.commit({type:"removeToy",toyId:e});return}catch(n){console.log(n)}},async saveToy(t,{toy:e}){try{const n=!!e._id,l=await x.saveToy(e);t.commit({type:n?"updateToy":"addToy",toy:l})}catch(n){console.log(n)}}},modules:{}};const A="auth";async function ls(t){return await _.post(A+"/login",t)}async function as(t){return await _.post(A+"/signup",t)}async function us(){return await _.post(A+"/logout")}const O={login:ls,signup:as,logout:us};var cs={state:{loggedinUser:null},getters:{getUser(t){return t.loggedinUser}},mutations:{setUser(t,{user:e}){t.loggedinUser=e}},actions:{async login({commit:t},{cred:e}){try{const n=await O.login(e);t({type:"setUser",user:n})}catch(n){console.log(n)}},async signup({commit:t},{cred:e}){try{const n=await O.signup(e);t({type:"setUser",user:n})}catch(n){console.log(n)}},async logout({commit:t}){try{await O.logout(),t({type:"setUser",user:null})}catch(e){console.log(e)}}}};const L="review";async function ds(t){return await _.get(L,t)}async function ys(t){return await _.post(L,t)}const E={query:ds,addReview:ys};var ps={state:{reviews:null},getters:{getReviews(t){return t.reviews}},mutations:{setReviews(t,{reviews:e}){t.reviews=e},addReview(t,{review:e}){t.reviews.push(e)}},actions:{async getReviews({commit:t},{filterBy:e}){try{const n=await E.query(e);t({type:"setReviews",reviews:n})}catch(n){console.log(n)}},async addReview(t,{content:e,toyId:n}){const l=t.rootGetters.getUser;if(!l)return N.push("/login");const s={content:e,userId:l._id,toyId:n};await E.addReview(s)}}};const ms=q({strict:!0,modules:{toyStore:is,userStore:cs,reviewStore:ps}});const I=W(ge);I.use(N);I.use(ms);I.use(X);I.mount("#app");
